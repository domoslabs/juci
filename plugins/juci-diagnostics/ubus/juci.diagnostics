#!/bin/sh

. /usr/share/libubox/jshn.sh

case "$1" in
	list)
		echo '{ "ping" : {"host":"str"}, "ping6" : {"host":"str"}, "traceroute" : {"host":"str"}, "traceroute6" : {"host":"str"} }'
	;;
	call)
		case "$2" in
			ping|ping6) CMND="$2 -c 5 -W 1" ;;
			traceroute|traceroute6) CMND="$2 -q 1 -w 1 -n" ;;
			*) return 1 ;;
		esac

		read input;

		json_load "$input"
		json_get_var host host
	
		json_init
		json_add_string stdout "$($CMND $host)"
		json_dump
	;;
esac
